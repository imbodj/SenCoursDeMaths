\input{../common}
\input{../bibliography}

\begin{document}
  %<*content>
  \lesson{algebra}{156}{Endomorphismes trigonalisables. Endomorphismes nilpotents.}

  Soit $E$ un espace vectoriel de dimension finie $n$ sur un corps $\mathbb{K}$. Tout au long de la leçon, on abusera du fait que $\mathcal{L}(E) \cong \mathcal{M}_n(\mathbb{K})$ : les notions définies pour les endomorphismes sont valables pour les matrices.

  \subsection{Endomorphismes trigonalisables}

  \subsubsection{Premiers outils de réduction}

  \reference[GOU21]{171}

  \begin{definition}
    Soient $u \in \mathcal{L}(E)$ et $\lambda \in \mathbb{K}$.
    \begin{itemize}
      \item On dit que $\lambda$ est \textbf{valeur propre} de $u$ si $u - \lambda \operatorname{id}_E$ est non injective.
      \item Un vecteur $x \neq 0$ tel que $u(x) = \lambda x$ est un \textbf{vecteur propre} de $u$ associé à la valeur propre $\lambda$.
      \item L'ensemble des valeurs propres de $u$ est appelé \textbf{spectre} de $u$. On le note $\operatorname{Sp}(u)$.
    \end{itemize}
  \end{definition}

  \begin{remark}
    Soit $u \in \mathcal{L}(E)$.
    \begin{itemize}
      \item $0$ est valeur propre de $u$ si et seulement si $\ker(f) \neq \{ 0 \}$.
      \item On peut définir de la même manière les mêmes notions pour une matrice de $\mathcal{M}_n(\mathbb{K})$ (une valeur est propre pour une matrice si et seulement si elle l'est pour l'endomorphisme associé). On reprendra les mêmes notations.
    \end{itemize}
  \end{remark}

  \begin{example}
    $\begin{pmatrix} 1 \\ 1 \\ 1 \end{pmatrix}$ est vecteur propre de $\begin{pmatrix} 0 & 2 & -1 \\ 3 & -2 & 0 \\ -2 & 2 & 1 \end{pmatrix}$ associé à la valeur propre $1$.
  \end{example}

  \reference[ROM21]{644}

  \begin{proposition}
    Soit $u \in \mathcal{L}(E)$. En notant $\chi_u = \det(X \operatorname{id}_E - u)$,
    \[ \operatorname{Sp}(u) = \{ \lambda \in \mathbb{K} \mid \chi_u(\lambda) = 0 \} \]
  \end{proposition}

  \begin{definition}
    Le polynôme $\chi_u$ précédent est appelé \textbf{polynôme caractéristique} de $u$.
  \end{definition}

  \begin{remark}
    On peut définir la même notion pour une matrice $A \in \mathcal{M}_n(\mathbb{K})$, ces deux notions coïncidant bien si $A$ est la matrice de $u$ dans une base quelconque de $E$.
  \end{remark}

  \begin{example}
    Pour $A = \begin{pmatrix} a & b \\ c & d \end{pmatrix} \in \mathcal{M}_2(\mathbb{K})$, on a $\chi_A = X^2 - \trace(A)X + \det(A)$.
  \end{example}

  \reference{604}

  \begin{lemma}
    Soit $u \in \mathcal{L}(E)$.
    \begin{enumerate}[label=(\roman*)]
      \item $\mathrm{Ann}(u) = \{ P \in \mathbb{K}[X] \mid P(u) = 0 \}$ est un sous-ensemble de $\mathbb{K}[u]$ non réduit au polynôme nul.
      \item $\mathrm{Ann}(u)$ est le noyau de $P \mapsto P(u)$ : c'est un idéal de $\mathbb{K}[u]$.
      \item Il existe un unique polynôme unitaire engendrant cet idéal.
    \end{enumerate}
  \end{lemma}

  \begin{definition}
    On appelle \textbf{idéal annulateur} de $u$ l'idéal $\mathrm{Ann}(u)$. Le polynôme unitaire générateur est noté $\pi_u$ et est appelé \textbf{polynôme minimal} de $u$.
  \end{definition}

  \begin{remark}
    En reprenant les notations précédentes,
    \begin{itemize}
      \item $\pi_u$ est le polynôme unitaire de plus petit degré annulant $u$.
      \item Si $A \in \mathcal{M}_n(\mathbb{K})$ est la matrice de $u$ dans une base de $E$, on a $\mathrm{Ann}(u) = \mathrm{Ann}(A)$ et $\pi_u = \pi_A$.
    \end{itemize}
  \end{remark}

  \begin{example}
    Un endomorphisme est nilpotent d'indice $q$ si et seulement si son polynôme minimal est $X^q$.
  \end{example}

  \begin{proposition}
    Soit $u \in \mathcal{L}(E)$. Soit $F$ un sous-espace vectoriel de $E$ stable par $u$. Alors, le polynôme minimal de l'endomorphisme $u_{|F} : F \rightarrow F$ divise $\pi_u$.
  \end{proposition}

  \begin{proposition}
    Soit $u \in \mathcal{L}(E)$.
    \begin{enumerate}[label=(\roman*)]
      \item Les valeurs propres de $u$ sont racines de tout polynôme annulateur.
      \item Les valeurs propres de $u$ sont exactement les racines de $\pi_u$.
    \end{enumerate}
  \end{proposition}

  \reference[GOU21]{186}

  \begin{remark}
    Soit $u \in \mathcal{L}(E)$. $\pi_u$ et $\chi_u$ partagent dont les mêmes racines.
  \end{remark}

  \reference[ROM21]{607}

  \begin{theorem}[Cayley-Hamilton]
    Soit $u \in \mathcal{L}(E)$. Alors,
    \[ \pi_u \mid \chi_u \]
  \end{theorem}

  \reference{609}

  \begin{theorem}[Lemme des noyaux]
    Soit $P = P_1 \dots P_k \in \mathbb{K}[X]$ où les polynômes $P_1, \dots, P_k$ sont premiers entre eux deux à deux. Alors, pour tout endomorphisme $u$ de $E$,
    \[ \ker(P(u)) = \bigoplus_{i=1}^k \ker(P_i(u)) \]
  \end{theorem}

  \subsubsection{Trigonalisation}

  \reference{675}

  \begin{definition}
    Soit $u \in \mathcal{L}(E)$.
    \begin{itemize}
      \item On dit que $u$ est \textbf{trigonalisable} s'il existe une base de $E$ dans laquelle la matrice de $u$ est triangulaire supérieure.
      \item On dit qu'une matrice $A \in \mathcal{M}_n(\mathbb{K})$ est \textbf{trigonalisable} si elle est semblable à une matrice diagonale.
    \end{itemize}
  \end{definition}

  \begin{remark}
    Un endomorphisme $u$ de $E$ est trigonalisable si et seulement si sa matrice dans n'importe quelle base de $E$ l'est.
  \end{remark}

  \begin{example}
    Une matrice à coefficients réels ayant des valeurs propres imaginaires pures n'est pas trigonalisable dans $\mathcal{M}_n(\mathbb{R})$.
  \end{example}

  \begin{theorem}
    Un endomorphisme $u$ de $E$ est trigonalisable sur $\mathbb{K}$ si et seulement si $\chi_u$ est scindé sur $\mathbb{K}$.
  \end{theorem}

  \begin{corollary}
    Si $\mathbb{K}$ est algébriquement clos, tout endomorphisme de $u$ est trigonalisable sur $\mathbb{K}$.
  \end{corollary}

  \begin{proposition}
    Soit $u \in \mathcal{L}(E)$. Si $u$ est trigonalisable, sa trace est la somme de ses valeurs propres et son déterminant est le produit de ses valeurs propres.
  \end{proposition}

  \dev{trigonalisation-simultanee}

  \begin{theorem}[Trigonalisation simultanée]
    Soit $(u_i)_{i \in I}$ une famille d'endomorphismes de $E$ diagonalisables qui commutent deux-à-deux. Alors, il existe une base commune de trigonalisation.
  \end{theorem}

  \subsection{Endomorphismes nilpotents}

  \subsubsection{Définition, caractérisation}

  \reference[BMP]{168}

  \begin{definition}
    On note
    \[ \mathcal{N}(E) = \{ u \in \mathcal{L}(E) \mid \exists p \in \mathbb{N} \text{ tel que } u^p = 0 \} \]
    l'ensemble des éléments \textbf{nilpotents} de $\mathcal{L}(E)$.
  \end{definition}

  \begin{example}
    Dans $\mathbb{K}_n[X]$, l'opérateur de dérivation $P \mapsto P'$ est nilpotent.
  \end{example}

  \begin{definition}
    On appelle \textbf{indice de nilpotence} d'un endomorphisme $u \in \mathcal{N}(E)$ l'entier $q$ tel que
    \[ q = \inf \{ p \in \mathbb{N} \mid u^p = 0 \} \]
  \end{definition}

  \begin{proposition}
    Soit $u \in \mathcal{L}(E)$. Alors,
    \[ u \text{ est nilpotent d'indice } p \iff \pi_u = X^p \]
    En particulier, $p \leq n$.
  \end{proposition}

  \begin{theorem}
    \label{156-1}
    Soit $u \in \mathcal{L}(E)$. Les assertions suivantes sont équivalentes :
    \begin{enumerate}[label=(\roman*)]
      \item $u \in \mathcal{N}(E)$.
      \item $\chi_u = (-1)^n X^n$.
      \item Il existe $p \in \mathbb{N}$ tel que $\pi_u = X^p$. Dans ce cas, $p$ est l'indice de nilpotence de $u$.
      \item $u$ est trigonalisable avec zéros sur la diagonale.
      \item $u$ est trigonalisable et sa seule valeur propre est $0$.
      \item $0$ est la seule valeur propre de $u$ dans toute extension algébrique de $\mathbb{K}$.
      \item \uline{Si $\operatorname{car}(\mathbb{K}) = 0$ :} $u$ et $\lambda u$ sont semblables pour tout $\lambda \in \mathbb{K}^*$.
    \end{enumerate}
  \end{theorem}

  \begin{cexample}
    La matrice
    \[
      A = \begin{pmatrix}
        0 & 0 & 0 \\
        0 & 0 & -1 \\
        0 & 1 & 0
      \end{pmatrix}
    \]
    n'est pas nilpotente, alors que $\chi_A = -X(X^2 + 1)$ n'admet que $0$ comme valeur propre réelle.
  \end{cexample}

  \begin{proposition}
    Soit $u \in \mathcal{L}(E)$. On suppose $\operatorname{car}(\mathbb{K}) = 0$. Alors,
    \[ u \in \mathcal{N}(E) \iff \forall k \in \mathbb{N}, \, \trace(u^k) = 0 \]
  \end{proposition}

  \subsubsection{Cône nilpotent}

  \begin{proposition}
    $\mathcal{N}(E)$ est un cône : si $u \in \mathcal{N}(E)$, alors $\forall \lambda \in \mathbb{K}, \, \lambda u \in \mathcal{N}(E)$.
  \end{proposition}

  \begin{remark}
    $\mathcal{N}(E)$ n'est pas un sous-groupe additif de $\mathcal{L}(E)$. Par exemple,
    \[
      A =
      \begin{pmatrix}
        0 & 1 \\
        0 & 0
      \end{pmatrix}
      +
      \begin{pmatrix}
        0 & 0 \\
        1 & 0
      \end{pmatrix}
    \]
    $A$ est somme de deux matrices nilpotentes, mais est inversible donc non nilpotente. En particulier, $\mathcal{N}(E)$ n'est ni un idéal, ni un sous-espace vectoriel de $\mathcal{L}(E)$.
  \end{remark}

  \begin{proposition}
    \[ \operatorname{Vect}(\mathcal{N}(E)) = \ker(\trace) \]
  \end{proposition}

  \begin{example}
    En dimension $2$,
    \[
      \begin{pmatrix}
        a & b \\
        c & d
      \end{pmatrix}
      \text{ est nilpotente}
      \iff
      -a^2 -bc = 0
    \]
  \end{example}

  \begin{proposition}
    Soient $u, v \in \mathcal{L}(E)$ tels que $uv = vu$.
    \begin{enumerate}[label=(\roman*)]
      \item Si $u, v \in \mathcal{N}(E)$, alors $u + v \in \mathcal{N}(E)$.
      \item Si $u \in \mathcal{N}(E)$, alors $uv \in \mathcal{N}(E)$.
    \end{enumerate}
  \end{proposition}

  \subsubsection{Unipotence}

  \reference{174}

  \begin{definition}
    On note
    \[ \mathcal{U}(E) = \operatorname{id}_E + \mathcal{N}(E) \]
    l'ensemble des endomorphismes \textbf{unipotents} de $E$.
  \end{definition}

  \begin{remark}
    On dispose de caractérisations analogues au \cref{156-1} pour les endomorphismes unipotents. Par exemple, un endomorphisme $u$ de $E$ est unipotent si et seulement si $\chi_u = (1-X)^n$.
  \end{remark}

  On se place dans le cas où $\mathbb{K} = \mathbb{R}$ ou $\mathbb{C}$ pour la fin de cette sous-section.

  \reference[ROM21]{767}

  \begin{proposition}
    Soit $u \in \mathcal{N}(E)$. Alors $e^u \in \mathcal{U}(E)$.
  \end{proposition}

  \begin{theorem}
    L'exponentielle matricielle réalise une bijection de $\mathcal{N}(E)$ sur $\mathcal{U}(E)$ d'inverse le logarithme matriciel.
  \end{theorem}

  \subsubsection{Sous-espaces caractéristiques, noyaux itérés}

  \reference[GOU21]{201}

  Soit $u \in \mathcal{L}(E)$ de polynôme caractéristique scindé, de la forme
  \[ \chi_u = \prod_{i=1}^{s} (X-\lambda_i)^{\alpha_i} \]

  \begin{definition}
    Soit $i \in \llbracket 1, s \rrbracket$. On appelle \textbf{sous-espace caractéristique} de $u$ associé à la valeur propre $\lambda_i$ le sous-espace vectoriel $N_i = \ker((u-\lambda_i \operatorname{id}_E)^{\alpha_i})$.
  \end{definition}

  \begin{proposition}
    Soit $i \in \llbracket 1, s \rrbracket$.
    \begin{enumerate}[label=(\roman*)]
      \item $N_i$ est stable par $u$.
      \item $\dim(N_i) = \alpha_i$.
      \item $\chi_{u_{|N_i}} = (-X)^{\dim(N_i)} = (-X)^{\alpha_i}$.
      \item $u_{|N_i}$ est nilpotent.
    \end{enumerate}
    De plus, $E = \oplus_{i=1}^s N_i$.
  \end{proposition}

  \begin{proposition}
    Soit $v \in \mathcal{L}(E)$.
    \begin{enumerate}[label=(\roman*)]
      \item La suite de sous-espaces vectoriels $(\ker(v^n))$ est décroissante, stationnaire.
      \item La suite de sous-espaces vectoriels $(\im(v^n))$ est croissante, stationnaire.
    \end{enumerate}
  \end{proposition}

  \reference[BMP]{171}

  \begin{definition}
    Un \textbf{bloc de Jordan} de taille $m$ associé à $\lambda \in \mathbb{K}$ désigne la matrice $J_m(\lambda)$ suivante :
    \[ J_m(\lambda) = \begin{pmatrix} \lambda & 1 & \\ & \ddots & \ddots & \\ & & \ddots & 1 \\ & & & \lambda \end{pmatrix} \in \mathcal{M}_m(\mathbb{K}) \]
  \end{definition}

  \begin{application}[Réduction de Jordan d'un endomorphisme nilpotent]
    On suppose que $u$ est nilpotent. Alors il existe des entiers $n_1 \geq \dots \geq n_p$ et une base $\mathcal{B}$ de $E$ tels que :
    \[ \operatorname{Mat}(u, \mathcal{B}) = \begin{pmatrix} J_{n_1}(0) & & \\ & \ddots & \\ & & J_{n_p}(0) \end{pmatrix} \]
    De plus, on a unicité dans cette décomposition.
  \end{application}

  \subsection{Applications}

  \subsubsection{Décomposition de Dunford}

  \reference[GOU21]{203}
  \dev{decomposition-de-dunford}

  \begin{theorem}[Décomposition de Dunford]
    Soit $u \in \mathcal{L}(E)$. On suppose que $\pi_u$ est scindé sur $\mathbb{K}$. Alors il existe un unique couple d'endomorphismes $(d, n)$ tels que :
    \begin{itemize}
      \item $d$ est diagonalisable et $n$ est nilpotent.
      \item $u = d + n$.
      \item $d n = n d$.
    \end{itemize}
  \end{theorem}

  \begin{corollary}
    Si $u$ vérifie les hypothèse précédentes, pour tout $k \in \mathbb{N}$, $u^k = (d + n)^k = \sum_{i=0}^m \binom{k}{i} d^i n^{k-i}$, avec $m = \min(k, l)$ où $l$ désigne l'indice de nilpotence de $n$.
  \end{corollary}

  \begin{remark}
    On peut montrer de plus que $d$ et $n$ sont des polynômes en $u$.
  \end{remark}

  \reference[ROM21]{687}

  \begin{theorem}[Décomposition de Dunford multiplicative]
    Soit $f \in \mathcal{L}(E)$. On suppose que $\pi_f$ est scindé sur $\mathbb{K}$. Alors il existe un unique couple d'endomorphismes $(d, u)$ tels que :
    \begin{itemize}
      \item $d$ est diagonalisable et $u$ est unipotente.
      \item $f = du$.
      \item $du = ud$.
    \end{itemize}
  \end{theorem}

  \subsubsection{Invariants de similitude}

  \reference[GOU21]{397}

  Soient $E$ un espace vectoriel de dimension finie $n$ et $u \in \mathcal{L}(E)$.

  \begin{definition}
    On dit que $u$ est \textbf{cyclique} s'il existe $x \in E$ tel que $\{ P(u)(x) \mid P \in \mathbb{K}[X] \} = E$.
  \end{definition}

  \begin{proposition}
    $u$ est cyclique si et seulement si $\deg(\pi_u) = n$.
  \end{proposition}

  \begin{definition}
    Soit $P = X^p + a_{p-1} X^{p-1} + \dots + a_0 \in \mathbb{K}[X]$. On appelle \textbf{matrice compagnon} de $P$ la matrice
    \[ \mathcal{C}(P) = \begin{pmatrix} 0 & \dots & \dots & 0 & -a_0 \\ 1 & 0 & \ddots & \vdots & -a_1 \\ 0 & 1 & \ddots & \vdots & \vdots \\ \vdots & \ddots & \ddots & 0 & -a_{p-2} \\ 0 & \dots & 0 & 1 & -a_{p-1} \end{pmatrix} \]
  \end{definition}

  \begin{proposition}
    $u$ est cyclique si et seulement s'il existe une base $\mathcal{B}$ de $E$ telle que $\operatorname{Mat}(u, \mathcal{B}) = \mathcal{C}(\pi_u)$.
  \end{proposition}

  \begin{theorem}
    Il existe $F_1, \dots, F_r$ des sous-espaces vectoriels de $E$ tous stables par $u$ tels que :
    \begin{itemize}
      \item $E = F_1 \oplus \dots \oplus F_r$.
      \item $u_i = u_{|F_i}$ est cyclique pour tout $i$.
      \item Si $P_i = \pi_{u_i}$, on a $P_{i+1} \mid P_i$ pour tout $i$.
    \end{itemize}
    La famille de polynômes $P_1, \dots, P_r$ ne dépend que de $u$ et non du choix de la décomposition. On l'appelle \textbf{suite des invariants de similitude} de $u$.
  \end{theorem}

  \begin{theorem}[Réduction de Frobenius]
    Si $P_1, \dots, P_r$ désigne la suite des invariants de $u$, alors il existe une base $\mathcal{B}$ de $E$ telle que :
    \[ \operatorname{Mat}(u, \mathcal{B}) = \begin{pmatrix} \mathcal{C}(P_1) & & \\ & \ddots & \\ & & \mathcal{C}(P_r) \end{pmatrix} \]
    On a d'ailleurs $P_1 = \pi_u$ et $P_1 \dots P_r = \chi_u$.
  \end{theorem}

  \begin{corollary}
    Deux endomorphismes de $E$ sont semblables si et seulement s'ils ont la même suite d'invariants de similitude.
  \end{corollary}

  \begin{application}
    Pour $n = 2$ ou $3$, deux matrices sont semblables si et seulement si elles ont mêmes polynômes minimal et caractéristique.
  \end{application}

  \begin{application}
    Soit $\mathbb{L}$ une extension de $\mathbb{K}$. Alors, si $A, B \in \mathcal{M}_n(\mathbb{K})$ sont semblables dans $\mathcal{M}_n(\mathbb{L})$, elles le sont aussi dans $\mathcal{M}_n(\mathbb{K})$.
  \end{application}

  \subsubsection{Commutant d'une matrice}

  Soit $A \in \mathcal{M}_n(\mathbb{K})$.

  \reference{289}

  \begin{lemma}
    Si $\pi_A = \chi_A$, alors $A$ est cyclique :
    \[ \exists x \in \mathbb{K}^n \setminus \{ 0 \} \text{ tel que } (x, Ax, \dots, A^{n-1}x) \text{ est une base de } \mathbb{K}^n \]
  \end{lemma}

  \reference[FGN2]{160}

  \begin{notation}
    \begin{itemize}
      \item On note $\mathcal{T}_n(\mathbb{K})$ l'ensemble des matrices carrées triangulaires supérieures d'ordre $n$ à coefficients dans le corps $\mathbb{K}$.
      \item On note $\mathcal{C}(A)$ le commutant de $A$.
    \end{itemize}
  \end{notation}

  \begin{lemma}
    \[ \dim_{\mathbb{K}}(\mathcal{C}(A)) \geq n \]
  \end{lemma}

  \begin{lemma}
    Le rang de $A$ est invariant par extension de corps.
  \end{lemma}

  \begin{theorem}
    \[ \mathbb{K}[A] = \mathcal{C}(A) \iff \pi_A = \chi_A \]
  \end{theorem}
  %</content>
\end{document}
