\input{../common}
\input{../bibliography}

\begin{document}
  %<*content>
  \lesson{algebra}{120}{Anneaux \texorpdfstring{$\mathbb{Z}/n\mathbb{Z}$}{Z/nZ}. Applications.}

  Soit $n \geq 2$ un entier.

  \subsection{L'anneau \texorpdfstring{$\mathbb{Z}/n\mathbb{Z}$}{Z/nZ}}

  \subsubsection{Construction}

  \reference[GOU21]{9}

  \begin{theorem}[Division euclidienne dans $\mathbb{Z}$]
    \[ \forall (a, b) \in \mathbb{Z}^2, \, \exists! (q, r) \in \mathbb{Z}^2 \text{ tel que } a=bq+r \text{ et } r \in \llbracket 0, \vert b \vert \rrbracket \]
  \end{theorem}

  \reference[ROM21]{279}

  \begin{definition}
    Soient $a, b \in \mathbb{Z}$. On dit que $a$ est \textbf{congru} à $b$ modulo $n$ si $n \mid b-a$. On note cela $a \equiv b \mod n$.
  \end{definition}

  \begin{proposition}
    \label{120-1}
    Soient $a, b, c, d \in \mathbb{Z}$ tels que $a \equiv b \mod n$ et $c \equiv d \mod n$. Alors :
    \begin{enumerate}[label=(\roman*)]
      \item $a+c \equiv b+d \mod n$.
      \item $ac \equiv bd \mod n$
    \end{enumerate}
  \end{proposition}

  \begin{lemma}
    Tout idéal de $\mathbb{Z}$ est principal, de la forme $(n) = n\mathbb{Z}$.
  \end{lemma}

  \begin{definition}
    Le quotient de l'anneau $\mathbb{Z}$ par son idéal $n\mathbb{Z}$ est l'anneau noté $\mathbb{Z}/n\mathbb{Z}$. On note $\overline{a} = \{ a + qn \mid q \in \mathbb{Z} \}$ l'image d'un élément $a \in \mathbb{Z}$ dans $\mathbb{Z}/n\mathbb{Z}$.
  \end{definition}

  \begin{remark}
    Soient $a, b \in \mathbb{Z}$.
    \[ \overline{a} = \overline{b} \iff a \equiv b \mod n \]
  \end{remark}

  \begin{proposition}
    \begin{enumerate}[label=(\roman*)]
      \item $\mathbb{Z}/n\mathbb{Z} = \{ \overline{0}, \dots, \overline{n-1} \}$.
      \item La compatibilité de $\equiv$ avec les lois $+$ et $\times$ sur $\mathbb{Z}$ conjuguée à la remarque précédente transporte la structure d'anneau à $\mathbb{Z}/n\mathbb{Z}$ en posant, pour tout $\overline{a}, \overline{b} \in \mathbb{Z}/n\mathbb{Z}$ :
      \begin{itemize}
        \item $\overline{a} + \overline{b} = \overline{a+b}$.
        \item $\overline{a} \overline{b} = \overline{ab}$.
      \end{itemize}
    \end{enumerate}
  \end{proposition}

  \subsubsection{Le groupe multiplicatif}

  \paragraph{Générateurs}

  \reference{283}

  \begin{theorem}
    \label{120-2}
    Soit $a \in \mathbb{Z}$. Les assertions suivantes sont équivalentes :
    \begin{enumerate}[label=(\roman*)]
      \item $\overline{a} \in (\mathbb{Z}/n\mathbb{Z})^\times$.
      \item $\operatorname{pgcd}(a,n)=1$.
      \item $a$ est un générateur de $(\mathbb{Z}/n\mathbb{Z}, +)$.
    \end{enumerate}
  \end{theorem}

  \reference{301}

  \begin{example}
    \label{120-3}
    $(\mathbb{Z}/4\mathbb{Z})^\times = \{ \pm \overline{1} \}$.
  \end{example}

  \reference{14}

  \begin{proposition}
    \begin{enumerate}[label=(\roman*)]
      \item $\mathbb{Z}$ est monogène, l'ensemble de ses générateurs est $\mathbb{Z}^\times = \{ \pm 1 \}$.
      \item $\mathbb{Z}/n\mathbb{Z}$, l'ensemble de ses générateurs est $(\mathbb{Z}/n\mathbb{Z})^\times$.
    \end{enumerate}
  \end{proposition}

  \begin{corollary}
    Soit $G$ un groupe.
    \begin{enumerate}[label=(\roman*)]
      \item Si $G$ est monogène infini, alors $G \cong \mathbb{Z}$.
      \item Si $G$ est cyclique d'ordre $n$, alors $G \cong \mathbb{Z}/n\mathbb{Z}$.
    \end{enumerate}
  \end{corollary}

  \begin{example}
    Le groupe des racines $n$-ièmes de l'unité, $\mu_n$, est isomorphe $\mathbb{Z}/n\mathbb{Z}$ via
    \[ \overline{k} \mapsto e^{\frac{2ik\pi}{n}} \]
  \end{example}

  \paragraph{Sous-groupes additifs et idéaux}

  \reference{281}

  \begin{theorem}
    Les sous-groupes additifs de $\mathbb{Z}/n\mathbb{Z}$ sont cycliques d'ordre divisant $n$. Réciproquement, pour tout diviseur $d$ de $n$, il existe un unique sous-groupe de $\mathbb{Z}/n\mathbb{Z}$, c'est le groupe cyclique engendré par $\overline{\frac{n}{d}}$.
  \end{theorem}

  \reference{255}

  \begin{theorem}
    \begin{enumerate}[label=(\roman*)]
      \item Les idéaux de $\mathbb{Z}/n\mathbb{Z}$ sont ses sous-groupes additifs.
      \item Les idéaux premiers de $\mathbb{Z}/n\mathbb{Z}$ sont les idéaux maximaux de $\mathbb{Z}/n\mathbb{Z}$ : ce sont les idéaux engendrés par $(\overline{p})$ où $p$ est un diviseur premier de $n$.
    \end{enumerate}
  \end{theorem}

  \subsubsection{Indicatrice d'Euler}

  \reference{283}

  \begin{definition}
    \textbf{L'indicatrice d'Euler} $\varphi$ est la fonction qui à un entier $k$, associe le nombre d'entiers compris entre $1$ et $n$ qui sont premiers avec $k$.
  \end{definition}

  \begin{remark}
    D'après le \cref{120-2}, $\varphi(n)$ est le nombre de générateurs de $\mathbb{Z}/n\mathbb{Z}$ et est également le cardinal de $(\mathbb{Z}/n\mathbb{Z})^\times$.
  \end{remark}

  \begin{example}
    \begin{itemize}
      \item Si $n$ est premier, $\varphi(n) = n-1$.
      \item $\varphi(4) = 2$ d'après l'\cref{120-3}.
    \end{itemize}
  \end{example}

  \reference[GOZ]{4}

  \begin{proposition}
    Pour tout $p$ premier et pour tout entier $n$,
    \[ \varphi(p^n) = p^n - p^{n-1} \]
  \end{proposition}
  
  \dev{theoreme-chinois}

  \begin{theorem}[Chinois]
    \label{120-4}
    Soient $n$ et $m$ deux entiers premiers entre eux. Alors,
    \[ \mathbb{Z}/nm\mathbb{Z} \equiv \mathbb{Z}/n\mathbb{Z} \times \mathbb{Z}/m\mathbb{Z} \]
  \end{theorem}

  \begin{corollary}
    $\forall m, n \in \mathbb{Z}$ premiers entre eux,
    \[ \varphi(mn) = \varphi(m)\varphi(n) \]
  \end{corollary}

  \begin{proposition}[Théorème Euler]
    Pour tout entier relatif $a$ premier avec $n$, $a^{\varphi(n)} \equiv 1 \mod n$.
  \end{proposition}

  \begin{proposition}[Petit théorème de Fermat]
    Pour tout entier relatif $a$, pour tout $p$ premier, $a^{p-1} \equiv 1 \mod p$.
  \end{proposition}

  \begin{proposition}
    Pour tout entier naturel $n$,
    \[ \sum_{d \mid n} \varphi(d) = n \]
  \end{proposition}

  \subsection{Cas où \texorpdfstring{$n$}{n} est premier}

  \subsubsection{Structure de corps}

  \begin{proposition}
    Les assertions suivantes sont équivalentes.
    \begin{enumerate}[label=(\roman*)]
      \item $n$ est un nombre premier.
      \item $\mathbb{Z}/n\mathbb{Z}$ est intègre.
      \item $\mathbb{Z}/n\mathbb{Z}$ est un corps.
    \end{enumerate}
  \end{proposition}

  \reference{83}

  \begin{theorem}
    Tout sous-groupe fini du groupe multiplicatif d'un corps commutatif est cyclique.
  \end{theorem}

  \begin{corollary}
    Si $p$ désigne un nombre premier, $(\mathbb{Z}/p\mathbb{Z})^\times$ est cyclique.
  \end{corollary}

  \reference[ROM21]{294}

  \begin{remark}
    On a un résultat encore plus fort : $(\mathbb{Z}/n\mathbb{Z})^\times$ est cyclique si et seulement si $n = 2, 4, p^\alpha \text{ ou } 2p^\alpha$ avec $p$ premier impair et $\alpha \geq 1$.
  \end{remark}

  \subsubsection{Carrés}

  \reference{427}

  \begin{remark}
    Tout élément de $\mathbb{Z}/2\mathbb{Z}$ est un carré.
  \end{remark}

  Soit $p$ un nombre premier impair.

  \begin{theorem}
    \begin{enumerate}[label=(\roman*)]
      \item Il y a $\frac{p-1}{2}$ carrés et autant de non carrés dans $(\mathbb{Z}/p\mathbb{Z})^\times$.
      \item Les carrés de $(\mathbb{Z}/p\mathbb{Z})^\times$ sont les racines de $X^{\frac{p-1}{2}} - 1$ et les non carrés celles de $X^{\frac{p-1}{2}} + 1$.
    \end{enumerate}
  \end{theorem}

  \begin{corollary}
    $-1$ est un carré dans $(\mathbb{Z}/p\mathbb{Z})^\times$ si et seulement si $p \equiv 1 \mod 4$.
  \end{corollary}

  \subsection{Applications}

  \subsubsection{Systèmes de congruences}

  \reference{289}

  \begin{proposition}
    Soit $a$ un entier non nul. L'équation
    \[ ax \equiv 1 \mod n \]
    admet des solutions si et seulement si $\operatorname{pgcd}(a,n) = 1$.
  \end{proposition}

  \begin{corollary}
    Soient $a$ un entier non nul et $b$ un entier relatif. L'équation
    \[ ax \equiv b \mod n \]
    a des solutions si et seulement si $d = \operatorname{pgcd}(a,n) \mid b$. Dans ce cas, l'ensemble des solutions est
    \[ \left\{ \frac{b}{d}x_0 + k\frac{n}{d} \mid k \in \mathbb{Z} \right\} \]
    où $x_0$ est une solution de l'équation $\frac{a}{n}x \equiv 1 \mod n$.
  \end{corollary}

  \reference{285}

  Pour résoudre des systèmes de congruences, on va préciser le \cref{120-4}.

  \begin{theorem}[Chinois]
    Soient $n_1, \dots, n_r \geq 2$ des entiers. On note $n = \prod_{i=1}^r n_i$ et $\pi_k = \pi_{{n_k}\mathbb{Z}}$ la surjection canonique de $\mathbb{Z}$ sur $\mathbb{Z}/k\mathbb{Z}$ pour tout $k \in \llbracket 1, r \rrbracket$.
    \newpar
    Les entiers $n_1, \dots, n_r$ sont premiers entre eux si et seulement si les anneaux $\mathbb{Z}/n\mathbb{Z}$ et $\prod_{i=1}^{r}\mathbb{Z}/n_i\mathbb{Z}$ sont isomorphes. Dans ce cas, l'isomorphisme est explicité par l'application
    \[
      \psi :
      \begin{array}{ccc}
        \mathbb{Z}/n\mathbb{Z} &\rightarrow& \prod_{i=1}^{r}\mathbb{Z}/n_i\mathbb{Z} \\
        \pi_{n}(k) &\mapsto& (\pi_i(k))_{i \in \llbracket 1, r \rrbracket}
      \end{array}
    \]
  \end{theorem}

  \reference{291}

  \begin{example}
    \[
      \begin{cases}
        k \equiv 2 \mod 4 \\
        k \equiv 3 \mod 5 \\
        k \equiv 1 \mod 9
      \end{cases}
    \]
    admet pour ensemble de solutions $\{ 838+180q \mid q \in \mathbb{Z} \}$.
  \end{example}

  \subsubsection{Étude d'équations diophantiennes}

  \paragraph{Entiers sommes de deux carrés}

  \reference[I-P]{137}

  \begin{notation}
    On note \[ N :
    \begin{array}{ccc}
      \mathbb{Z}[i] &\rightarrow& \mathbb{N} \\
      a+ib &\mapsto& a^2 + b^2
    \end{array}
    \] et $\Sigma$ l'ensemble des entiers qui sont somme de deux carrés.
  \end{notation}

  \begin{remark}
    $n \in \Sigma \iff \exists z \in \mathbb{Z}[i] \text{ tel que } N(z)=n$.
  \end{remark}

  \begin{theorem}[Deux carrés de Fermat]
    Soit $n \in \mathbb{N}^*$. Alors $n \in \Sigma$ si et seulement si $v_p(n)$ est pair pour tout $p$ premier tel que $p \equiv 3 \mod 4$ (où $v_p(n)$ désigne la valuation $p$-adique de $n$).
  \end{theorem}

  \paragraph{Premiers congrus à \texorpdfstring{$1$}{1} modulo \texorpdfstring{$n$}{n}}

  \reference[GOU21]{99}

  \begin{notation}
    On note $\Phi_n$ le $n$-ième polynôme cyclotomique.
  \end{notation}

  \begin{lemma}
    Soient $a \in \mathbb{N}$ et $p$ premier tels que $p \mid \Phi_n(a)$ mais $p \nmid \Phi_d(a)$ pour tout diviseur strict $d$ de $n$. Alors $p \equiv 1 \mod n$.
  \end{lemma}

  \dev{theoreme-de-dirichlet-faible}

  \begin{theorem}[Dirichlet faible]
    Pour tout entier $n$, il existe une infinité de nombres premiers congrus à $1$ modulo $n$.
  \end{theorem}

  \subsubsection{Irréductibilité de polynômes}

  \reference[GOZ]{10}

  \begin{lemma}[Gauss]
    \begin{enumerate}[label=(\roman*)]
      \item Le produit de deux polynômes primitifs est primitif (ie. dont le PGCD des coefficients est égal à $1$).
      \item $\forall P, Q \in \mathbb{Z}[X] \setminus \{ 0 \}$, $\gamma(PQ) = \gamma(P) \gamma(Q)$ (où $\gamma(P)$ est le contenu du polynôme $P$).
    \end{enumerate}
  \end{lemma}

  \begin{theorem}[Critère d'Eisenstein]
    Soit $P = \sum_{i=0}^n a_i X^i \in \mathbb{Z}[X]$ de degré $n \geq 1$. On suppose qu'il existe $p$ premier tel que :
    \begin{enumerate}[label=(\roman*)]
      \item $p \mid a_i$, $\forall i \in \llbracket 0, n-1 \rrbracket$.
      \item $p \nmid a_n$.
      \item $p^2 \nmid a_0$.
    \end{enumerate}
    Alors $P$ est irréductible dans $\mathbb{Q}[X]$.
  \end{theorem}

  \reference[PER]{67}

  \begin{application}
    Soit $n \in \mathbb{N}^*$. Il existe des polynômes irréductibles de degré $n$ sur $\mathbb{Z}$.
  \end{application}

  \reference[GOZ]{12}

  \begin{theorem}[Critère d'irréductibilité modulo $p$]
    Soit $P = \sum_{i=0}^n a_i X^i \in \mathbb{Z}[X]$ de degré $n \geq 1$. Soit $p$ un premier. On suppose $p \nmid a_n$.
    \newpar
    Si $\overline{P}$ est irréductible dans $(\mathbb{Z}/p\mathbb{Z})[X]$, alors $P$ est irréductible dans $\mathbb{Q}[X]$.
  \end{theorem}

  \begin{example}
    Le polynôme $X^3-127X^2+3608X+19$ est irréductible dans $\mathbb{Z}[X]$.
  \end{example}

  \subsubsection{Chiffrement RSA}

  \reference[ULM18]{62}

  \begin{definition}
    Afin de chiffrer un \textbf{message} (tout entier découpé en séquence d'entiers de taille bornée) en utilisant RSA, on doit a besoin de deux clés :
    \begin{itemize}
      \item Une \textbf{clé privée}, qui est un couple de nombres premiers $(p,q)$.
      \item La \textbf{clé publique} correspondante, qui est le couple $(n,e)$ où $n = pq$ et $e$ est l'inverse de $d$ modulo $\phi(n)$ où $d$ désigne un nombre premier à $\phi(n)$.
    \end{itemize}
  \end{definition}

  Nous conserverons ces notations pour la suite.

  \begin{theorem}[Chiffrement RSA]
    Soit $m = (m_i)_{i \in \llbracket 1, r \rrbracket}$ un message où pour tout $i$, $m_i < n$.
    \begin{enumerate}[label=(\roman*)]
      \item Possédant la clé publique, on peut \textit{chiffrer} ce message en un message $m'$ :
      \[ m' = (m_i^e)_{i \in \llbracket 1, r \rrbracket} \]
      \item Possédant la clé privée, on peut \textit{déchiffrer} le message $m'$ pour reconstituer $m$ :
      \[ \forall i \in \llbracket 1, r \rrbracket, \, (m_i^e)^d \equiv d \mod n \]
    \end{enumerate}
  \end{theorem}

  \begin{remark}
    \begin{itemize}
      \item L'intérêt vient pour des premiers $p$ et $q$ très grands : il devient alors très compliqué de factoriser $n$ et d'obtenir la clé privée.
      \item Les inverses peuvent se calculer à l'aide de l'algorithme de Bézout.
    \end{itemize}
  \end{remark}
  %</content>
\end{document}
